*   TODO: document every method
*   TODO: merge SD1.5 and flux pipelines
*   TODO: batch control
*   TODO: add testscases