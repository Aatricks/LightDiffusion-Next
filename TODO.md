*   TODO: document every method
*   TODO: merge SD1.5 and flux pipelines
*   TODO: seed and batch control
*   TODO: add testscases